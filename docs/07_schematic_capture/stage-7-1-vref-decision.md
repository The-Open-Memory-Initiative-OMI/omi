# Stage 7.1 — VREF Strategy Decision (OMI v1)

## Status
Locked

## Date
2025-12-27

## Scope
Applies to **OMI v1 DDR4 UDIMM** schematic capture and all downstream implementation stages.

---

## 1. Context

During Stage 7.1 (Power & PDN schematic preparation), a decision was required regarding **VREF sourcing strategy** for the DDR4 UDIMM.

VREF is a noise-sensitive reference voltage used by DRAM input comparators to determine logic thresholds for data, strobe, and command/address signals.  
It is **not a power rail**, but a reference used for signal interpretation.

Incorrect handling of VREF can lead to intermittent or non-deterministic memory failures.

---

## 2. Considered Options

### Option A — Host-Provided VREF
- VREF is generated by the host platform (motherboard or memory controller environment)
- VREF is supplied to the DIMM via the UDIMM edge connector
- The DIMM is responsible only for **distribution and local decoupling**

### Option B — DIMM-Generated VREF
- VREF is generated locally on the DIMM (typically derived from VDDQ)
- The DIMM assumes responsibility for reference generation quality and stability

Both options are valid in DDR4 systems and are permitted by JEDEC specifications.

---

## 3. Decision

### ✅ **Option A — Host-Provided VREF is selected for OMI v1**

This decision is **locked** for OMI v1.

---

## 4. Rationale

Option A was selected based on the following considerations:

- **Lower schematic and system complexity**
- **Fewer analog failure modes** in a first-generation design
- **Clearer debug and validation behavior** during bring-up
- **Better alignment with conservative, JEDEC-aligned UDIMM implementations**
- **Improved educational clarity** for an open, reference-oriented project

The goal of OMI v1 is correctness, reproducibility, and clarity rather than maximal autonomy or optimization.

---

## 5. Architectural Implications

With Option A selected:

- The DIMM **shall not** generate VREF locally
- No resistor dividers, buffers, or regulators may be used to create VREF on-DIMM
- VREF must be treated as:
  - noise-sensitive
  - locally decoupled
  - distributed carefully to DRAM devices
- VREF sourcing responsibility is explicitly assigned to the host platform

Any deviation from these constraints requires reopening this decision and revisiting Stage 6/7 assumptions.

---

## 6. Schematic Impact (Stage 7)

On the **Power & PDN schematic page**:

- VREF must appear as a named rail
- VREF must connect to the UDIMM edge connector
- Only local decoupling elements are permitted
- No VREF generation circuitry may appear

This document is the authoritative reference for VREF handling in Stage 7.

---

## 7. Forward Compatibility

Alternative VREF strategies (including DIMM-generated VREF) may be explored in future revisions (e.g., OMI v2), but are **explicitly out of scope** for OMI v1.

---

## 8. Decision Lock

This decision is considered **final** for OMI v1 unless explicitly reopened through a documented architectural change process.

---

*End of document*
